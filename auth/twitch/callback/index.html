<!DOCTYPE html>
<html>
<head>
  <title>Twitch Login Callback</title>
  <meta charset="utf-8">
</head>
<body>
  <script>
    // Extract token or error from URL hash
    function getTokenFromHash() {
      const match = window.location.hash.match(/access_token=([^&]+)/);
      return match ? match[1] : null;
    }
    function getErrorFromHash() {
      const match = window.location.hash.match(/error=([^&]+)/);
      return match ? match[1] : null;
    }

    const token = getTokenFromHash();
    const error = getErrorFromHash();

    if (token) {
      localStorage.setItem('twitch_access_token', token);
      window.location.hash = '';
      // Redirect to your main app page after successful login
      window.location.href = '/'; // Change this if your main page is elsewhere
    } else if (error) {
      document.body.innerHTML = `<h2>OAuth Error: ${error}</h2>`;
    } else {
      // No token or error, show a message or redirect as fallback
      document.body.innerHTML = '<h2>No token found. Please try logging in again.</h2>';
    }
  </script>
</body>
</html>
